## 大型网站面临的问题

* 高并发，大流量
* 高可用：7 * 24不宕机
* 海量数据
* 用户分布广泛，网络环境复杂
* 安全
* 需求频繁变更，发布频繁
* 网站渐进式演进

## 大型网站的演化

### 小型网站

单机足以

![image](../../../../styles/images/小型网站.png)

### 应用和数据分离

用户量增加导致性能下降，数据量的增加导致存储空间不足

![image](../../../../styles/images/应用和数据分离.png)

### 缓存改善数据访问性能

通过缓存少量常用数据，改善网站性能，本地缓存更快，远程分布式缓存不受容量限制

![image](../../../../styles/images/缓存改善数据访问性能.png)

### 应用服务器集群

使用应用服务器集群改善应用服务器的负载压力，提高并发访问量

![image](../../../../styles/images/应用服务器集群.png)

### 数据库读写分离

使用主从数据库完成数据库的读写分离，改善数据库的负载

![image](../../../../styles/images/数据库读写分离.png)

### 反向代理和CDN

使用反向代理和CDN来解决复杂的网络环境问题，加快响应，缓解应用的压力

![image](../../../../styles/images/反向代理和CDN.png)

### 分布式数据库和分布式文件系统

当单数据库容量不能满足需求时，通过业务分表分库，甚至单标水平分库待解决容量问题  
当单文件系统不能满足容量需求时，使用分布式的文件系统解决

![image](../../../../styles/images/分布式数据库和分布式文件系统.png)

### NoSQL和搜索引擎

使用NoSQL数据库解决存储和访问非关系型数据的需求，使用搜索引擎完成这些数据的检索

![image](../../../../styles/images/NoSQL和搜索引擎.png)

### 业务拆分

当业务变得复杂，单应用难以维护，通过把业务拆分成多个应用，分别开发、部署在不同的应用服务器中，由多个团队来维护；各个业务应用之间通过超链接、消息队列、访问相同数据库来完成协作

![image](../../../../styles/images/业务拆分.png)

### 分布式服务

随着业务越来越复杂，存储系统越来越庞大，应用服务器和存储系统之间的连接规模过于庞大导致连接资源不足；而各应用都有相同的业务操作，通过抽取公用的业务模块，由它们来连接数据库，通过分布式调用完成业务操作

![image](../../../../styles/images/分布式服务.png)

## 网站架构模式

### 分层

对应用进行分层，便于开发和维护，但要合理规划各层间的接口，严禁跨层调用和反向调用；当需要支持分布式的情况下，不同层可以分别部署

### 分割

当业务和功能越来越复杂，通过将不同业务和功能进行拆分，封装成单独模块分别部署来简化开发和维护，分布式的部署还能提高网站的性能

### 分布式

通过把应用和服务分布式部署和调用，来处理高并发访问和海量数据的问题；但引入了很多挑战：网络调用对性能的影响，大量服务器导致宕机风险增大，数据的不一致性问题，模块直接的依赖错综复杂

常用的分布式方案：

* 分布式应用和服务：分层和分割后的应用和服务模块分布式部署
* 